{% load static %}
{% if products %}
  {% for prod in products %}
  <article class="card" data-category="{{ prod.category.id }}" data-price="{{ prod.price }}">
    {% if prod.image %}
      <a href="{% url 'product_view' pk=prod.id %}"><img src="{{ prod.image.url }}" alt="{{ prod.title }}"></a>
    {% else %}
      <a href="{% url 'product_view' pk=prod.id %}"><img src="https://via.placeholder.com/400x300?text=No+Image" alt="No image"></a>
    {% endif %}
    <div class="title"><a href="{% url 'product_view' pk=prod.id %}">{{ prod.title }}</a></div>
    <div class="price">${{ prod.price }}</div>
    {% if prod.old_price %}
      <div style="font-size: 0.9rem; color: #999; text-decoration: line-through; padding: 0 1rem;">${{ prod.old_price }}</div>
      <div style="font-size: 0.85rem; color: #d32f2f; padding: 0 1rem;">Discount: {{ prod.discount_percentage }}%</div>
    {% endif %}
    <div class="category">{{ prod.category.title }}</div>
    <div class="actions">
      <input type="hidden" class="product-id-{{ prod.id }}" value="{{ prod.id }}">
      <input type="hidden" class="product-title-{{ prod.id }}" value="{{ prod.title }}">
      <input type="hidden" class="product-price-{{ prod.id }}" value="{{ prod.price }}">
      <input type="hidden" class="product-image-{{ prod.id }}" value="{% if prod.image %}{{ prod.image.url }}{% else %}https://via.placeholder.com/400x300?text=No+Image{% endif %}">
      <button class="btn btn-primary add-to-cart-btn" data-product-id="{{ prod.id }}">Add to cart</button>
      <button class="btn btn-ghost add-to-wishlist" data-product-id="{{ prod.id }}" onclick="addToWishlist(this)">â™¡</button>
    </div>
  </article>
  {% endfor %}
{% else %}
  <p class="no-products">No products match your filters.</p>
{% endif %}